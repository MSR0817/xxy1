<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>雷州半岛红树林面积与增长率变化</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        #chart-container {
            width: 1000px;
            height: 650px;
            margin: 20px auto;
            font-family: "Microsoft YaHei", sans-serif;
        }
        .header {
            text-align: center;
            margin-bottom: 15px;
        }
        h1 {
            font-size: 20px;
            color: #333;
            margin-bottom: 5px;
            font-weight: normal;
        }
        .subtitle {
            font-size: 13px;
            color: #666;
        }
        .legend {
            display: flex;
            justify-content: center;
            margin-top: 10px;
            gap: 20px;
            flex-wrap: wrap;
        }
        .legend-item {
            display: flex;
            align-items: center;
            font-size: 12px;
            margin: 0 10px;
        }
        .legend-color {
            width: 12px;
            height: 12px;
            margin-right: 5px;
            border-radius: 2px;
        }
    </style>
</head>
<body>
<div id="chart-container">
    <div class="header">
        <h1>雷州半岛红树林面积与增长率变化 (2001-2021)</h1>
        <div class="subtitle">柱状图：三年面积对比 | 折线图：时段增长率</div>
    </div>
    <div id="main-chart" style="width:100%;height:550px;"></div>
    <div class="legend">
        <div class="legend-item">
            <div class="legend-color" style="background:#5470C6;"></div>
            <span>2001年面积</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background:#91CC75;"></div>
            <span>2010年面积</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background:#EE6666;"></div>
            <span>2021年面积</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background:#FAC858;"></div>
            <span>2001-2010增长率</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background:#73C0DE;"></div>
            <span>2010-2021增长率</span>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        var chart = echarts.init(document.getElementById('main-chart'));

        // 完整数据集
        var regions = ['赤坎区','雷州市','廉江市','坡头区','遂溪县','吴川市','霞山区','徐闻县','麻章区'];
        var year2001 = [0.112,798.328,952.523,291.693,436.071,676.300,25.556,531.029,1539.882];
        var year2010 = [0.023,1203.047,1349.96,292.207,654.519,717.027,26.785,645.261,1427.106];
        var year2021 = [5.400,1743.733,1383.410,330.192,742.654,776.852,31.086,786.049,1471.198];

        // 计算增长率（百分比）
        function calculateGrowth(start, end) {
            return start.map((v, i) => {
                return v === 0 ? 0 : ((end[i] - v) / v * 100).toFixed(1);
            });
        }
        var growth2001_2010 = calculateGrowth(year2001, year2010);
        var growth2010_2021 = calculateGrowth(year2010, year2021);

        var option = {
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'cross',
                    crossStyle: {
                        color: '#999'
                    }
                },
                formatter: function(params) {
                    var result = `<div style="font-weight:bold;margin-bottom:8px">${params[0].name}</div>`;

                    // 面积数据
                    result += `
                        <div style="display:flex;justify-content:space-between">
                            <span style="color:#5470C6">2001年:</span>
                            <span>${params[0].value} hm²</span>
                        </div>
                        <div style="display:flex;justify-content:space-between">
                            <span style="color:#91CC75">2010年:</span>
                            <span>${params[1].value} hm²</span>
                        </div>
                        <div style="display:flex;justify-content:space-between">
                            <span style="color:#EE6666">2021年:</span>
                            <span>${params[2].value} hm²</span>
                        </div>
                    `;

                    // 增长率数据
                    var idx = params[0].dataIndex;
                    result += `
                        <div style="border-top:1px dashed #eee;margin:5px 0;padding-top:5px">
                            <div style="display:flex;justify-content:space-between">
                                <span style="color:#FAC858">2001-2010:</span>
                                <span>${growth2001_2010[idx]}%</span>
                            </div>
                            <div style="display:flex;justify-content:space-between">
                                <span style="color:#73C0DE">2010-2021:</span>
                                <span>${growth2010_2021[idx]}%</span>
                            </div>
                        </div>
                    `;

                    return result;
                }
            },
            legend: {
                data: ['2001年面积', '2010年面积', '2021年面积', '2001-2010增长率', '2010-2021增长率'],
                top: 30
            },
            grid: {
                left: '60px',
                right: '80px',
                top: '80px',
                bottom: '80px'
            },
            xAxis: {
                type: 'category',
                data: regions,
                axisLabel: {
                    rotate: 30,
                    fontSize: 12,
                    margin: 15
                },
                axisPointer: {
                    type: 'shadow'
                }
            },
            yAxis: [
                {
                    type: 'value',
                    name: '面积 (hm²)',
                    nameLocation: 'middle',
                    nameGap: 30,
                    axisLine: {
                        lineStyle: {
                            color: '#5470C6'
                        }
                    },
                    axisLabel: {
                        formatter: function(value) {
                            return value >= 1000 ? (value/1000).toFixed(1) + 'k' : value;
                        }
                    },
                    splitLine: {
                        lineStyle: {
                            type: 'dashed'
                        }
                    }
                },
                {
                    type: 'value',
                    name: '增长率 (%)',
                    nameLocation: 'middle',
                    nameGap: 30,
                    axisLine: {
                        lineStyle: {
                            color: '#FAC858'
                        }
                    },
                    axisLabel: {
                        formatter: '{value}%'
                    },
                    splitLine: {
                        show: false
                    }
                }
            ],
            series: [
                // 三年面积柱状图（细柱）
                {
                    name: '2001年面积',
                    type: 'bar',
                    barWidth: 18,
                    barGap: '30%',
                    data: year2001,
                    itemStyle: {
                        color: '#5470C6',
                        borderRadius: [2, 2, 0, 0]
                    },
                    label: {
                        show: true,
                        position: 'insideBottom',
                        formatter: function(params) {
                            return params.value > 1000 ? (params.value/1000).toFixed(1)+'k' : params.value;
                        },
                        fontSize: 10,
                        color: '#fff'
                    }
                },
                {
                    name: '2010年面积',
                    type: 'bar',
                    barWidth: 18,
                    data: year2010,
                    itemStyle: {
                        color: '#91CC75',
                        borderRadius: [2, 2, 0, 0]
                    },
                    label: {
                        show: true,
                        position: 'insideBottom',
                        formatter: function(params) {
                            return params.value > 1000 ? (params.value/1000).toFixed(1)+'k' : params.value;
                        },
                        fontSize: 10,
                        color: '#fff'
                    }
                },
                {
                    name: '2021年面积',
                    type: 'bar',
                    barWidth: 18,
                    data: year2021,
                    itemStyle: {
                        color: '#EE6666',
                        borderRadius: [2, 2, 0, 0]
                    },
                    label: {
                        show: true,
                        position: 'insideBottom',
                        formatter: function(params) {
                            return params.value > 1000 ? (params.value/1000).toFixed(1)+'k' : params.value;
                        },
                        fontSize: 10,
                        color: '#fff'
                    }
                },
                // 增长率折线图
                {
                    name: '2001-2010增长率',
                    type: 'line',
                    yAxisIndex: 1,
                    symbol: 'diamond',
                    symbolSize: 10,
                    lineStyle: {
                        width: 3,
                        type: 'dashed'
                    },
                    data: growth2001_2010,
                    itemStyle: {
                        color: '#FAC858'
                    },
                    label: {
                        show: true,
                        position: 'top',
                        formatter: function(params) {
                            return params.value + '%';
                        },
                        fontSize: 11,
                        color: '#FAC858'
                    }
                },
                {
                    name: '2010-2021增长率',
                    type: 'line',
                    yAxisIndex: 1,
                    symbol: 'triangle',
                    symbolSize: 10,
                    lineStyle: {
                        width: 3
                    },
                    data: growth2010_2021,
                    itemStyle: {
                        color: '#73C0DE'
                    },
                    label: {
                        show: true,
                        position: 'bottom',
                        formatter: function(params) {
                            return params.value + '%';
                        },
                        fontSize: 11,
                        color: '#73C0DE'
                    }
                }
            ]
        };

        chart.setOption(option);

        window.addEventListener('resize', function() {
            chart.resize();
        });
    });
</script>
</body>
</html>